<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_65) on Tue Aug 05 21:46:34 PDT 2014 -->
<title>MessageChooser (samza-api 0.8.0-SNAPSHOT API)</title>
<meta name="date" content="2014-08-05">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="MessageChooser (samza-api 0.8.0-SNAPSHOT API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/samza/system/chooser/BaseMessageChooser.html" title="class in org.apache.samza.system.chooser"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../org/apache/samza/system/chooser/MessageChooserFactory.html" title="interface in org.apache.samza.system.chooser"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/samza/system/chooser/MessageChooser.html" target="_top">Frames</a></li>
<li><a href="MessageChooser.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.samza.system.chooser</div>
<h2 title="Interface MessageChooser" class="title">Interface MessageChooser</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../../../org/apache/samza/system/chooser/BaseMessageChooser.html" title="class in org.apache.samza.system.chooser">BaseMessageChooser</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="strong">MessageChooser</span></pre>
<div class="block">MessageChooser is an interface for programmatic fine-grain control over
 stream consumption.

 <p>Consider the case of a Samza task consuming multiple streams, where some
 streams may be from live systems that have stricter SLA requirements and must
 always be prioritized over other streams that may be from batch systems.
 MessageChooser allows developers to inject message prioritization logic into
 the SamzaContainer.

 <p>In general, the MessageChooser can be used to prioritize certain systems,
 streams or partitions over others. It can also be used to throttle certain
 partitions, by choosing not to return messages even though they are
 available. The MessageChooser can also throttle the entire SamzaContainer by
 performing a blocking operation, such as Thread.sleep.

 <p>The manner in which MessageChooser is used is:

 <ul>
 <li>SystemConsumers buffer messages from all SystemStreamPartitions as they
 become available.</li>
 <li>If MessageChooser has no messages for a given SystemStreamPartition, and
 a SystemConsumer has a message in its buffer for the SystemStreamPartition,
 the MessageChooser will be updated once with the next message in the buffer.</li>
 <li>When SamzaContainer is ready to process another message, it calls
 SystemConsumers.choose, which in turn calls <a href="../../../../../org/apache/samza/system/chooser/MessageChooser.html#choose()"><code>choose()</code></a>.</li>
 </ul>

 <p>Since the MessageChooser only receives one message at a time per
 <a href="../../../../../org/apache/samza/system/SystemStreamPartition.html" title="class in org.apache.samza.system"><code>SystemStreamPartition</code></a>, it can be used to order messages between different
 SystemStreamPartitions, but it can't be used to re-order messages within a
 single SystemStreamPartition (a buffered sort). This must be done within a
 StreamTask.

 <p>The contract between the MessageChooser and the SystemConsumers is:

 <ul>
 <li><a href="../../../../../org/apache/samza/system/chooser/MessageChooser.html#update(org.apache.samza.system.IncomingMessageEnvelope)"><code>update(IncomingMessageEnvelope)</code></a> can be called multiple times
 before <a href="../../../../../org/apache/samza/system/chooser/MessageChooser.html#choose()"><code>choose()</code></a> is called.</li>
 <li>If <a href="../../../../../org/apache/samza/system/chooser/MessageChooser.html#choose()"><code>choose()</code></a> returns null, that means no envelopes should be
 processed at the moment.</li>
 <li>A MessageChooser may elect to return null when <a href="../../../../../org/apache/samza/system/chooser/MessageChooser.html#choose()"><code>choose()</code></a> is
 called, even if unprocessed messages have been given by the update method.</li>
 <li>A MessageChooser will not have any of its in-memory state restored in the
 event of a failure.</li>
 <li>Blocking operations (such as Thread.sleep) will block all processing in
 the entire SamzaContainer.</li>
 <li>A MessageChooser should never return the same envelope more than once.</li>
 <li>Non-deterministic (e.g. time-based) MessageChoosers are allowed.</li>
 <li>A MessageChooser does not need to be thread-safe.</li>
 </ul></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/apache/samza/system/IncomingMessageEnvelope.html" title="class in org.apache.samza.system">IncomingMessageEnvelope</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/samza/system/chooser/MessageChooser.html#choose()">choose</a></strong>()</code>
<div class="block">The choose method is invoked when the SamzaContainer is ready to process a
 new message.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/samza/system/chooser/MessageChooser.html#register(org.apache.samza.system.SystemStreamPartition,%20java.lang.String)">register</a></strong>(<a href="../../../../../org/apache/samza/system/SystemStreamPartition.html" title="class in org.apache.samza.system">SystemStreamPartition</a>&nbsp;systemStreamPartition,
        java.lang.String&nbsp;offset)</code>
<div class="block">Called before start, to let the chooser know that it will be handling
 envelopes from the given SystemStreamPartition.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/samza/system/chooser/MessageChooser.html#start()">start</a></strong>()</code>
<div class="block">Called after all SystemStreamPartitions have been registered.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/samza/system/chooser/MessageChooser.html#stop()">stop</a></strong>()</code>
<div class="block">Called when the chooser is about to be discarded.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/samza/system/chooser/MessageChooser.html#update(org.apache.samza.system.IncomingMessageEnvelope)">update</a></strong>(<a href="../../../../../org/apache/samza/system/IncomingMessageEnvelope.html" title="class in org.apache.samza.system">IncomingMessageEnvelope</a>&nbsp;envelope)</code>
<div class="block">Notify the chooser that a new envelope is available for a processing.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="start()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>start</h4>
<pre>void&nbsp;start()</pre>
<div class="block">Called after all SystemStreamPartitions have been registered. Start is used
 to notify the chooser that it will start receiving update and choose calls.</div>
</li>
</ul>
<a name="stop()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stop</h4>
<pre>void&nbsp;stop()</pre>
<div class="block">Called when the chooser is about to be discarded. No more messages will be
 given to the chooser after it is stopped.</div>
</li>
</ul>
<a name="register(org.apache.samza.system.SystemStreamPartition, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>register</h4>
<pre>void&nbsp;register(<a href="../../../../../org/apache/samza/system/SystemStreamPartition.html" title="class in org.apache.samza.system">SystemStreamPartition</a>&nbsp;systemStreamPartition,
            java.lang.String&nbsp;offset)</pre>
<div class="block">Called before start, to let the chooser know that it will be handling
 envelopes from the given SystemStreamPartition. Register will only be
 called before start.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>systemStreamPartition</code> - A SystemStreamPartition that envelopes will be coming from.</dd><dd><code>offset</code> - The offset of the first message expected for the
          system/stream/partition that's being registered. If "7" were
          supplied as the offset, then the MessageChooser can expect the
          first message it is updated with for the system/stream/partition
          will have an offset of "7".</dd></dl>
</li>
</ul>
<a name="update(org.apache.samza.system.IncomingMessageEnvelope)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>update</h4>
<pre>void&nbsp;update(<a href="../../../../../org/apache/samza/system/IncomingMessageEnvelope.html" title="class in org.apache.samza.system">IncomingMessageEnvelope</a>&nbsp;envelope)</pre>
<div class="block">Notify the chooser that a new envelope is available for a processing. A
 MessageChooser will receive, at most, one outstanding envelope per
 system/stream/partition combination. For example, if update is called for
 partition 7 of kafka.mystream, then update will not be called with an
 envelope from partition 7 of kafka.mystream until the previous envelope has
 been returned via the choose method. Update will only be invoked after the
 chooser has been started.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>envelope</code> - An unprocessed envelope.</dd></dl>
</li>
</ul>
<a name="choose()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>choose</h4>
<pre><a href="../../../../../org/apache/samza/system/IncomingMessageEnvelope.html" title="class in org.apache.samza.system">IncomingMessageEnvelope</a>&nbsp;choose()</pre>
<div class="block">The choose method is invoked when the SamzaContainer is ready to process a
 new message. The chooser may elect to return any envelope that it's been
 given via the update method, which hasn't yet been returned. Choose will
 only be called after the chooser has been started.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The next envelope to process, or null if the chooser has no
         messages or doesn't want to process any at the moment.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/samza/system/chooser/BaseMessageChooser.html" title="class in org.apache.samza.system.chooser"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../org/apache/samza/system/chooser/MessageChooserFactory.html" title="interface in org.apache.samza.system.chooser"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/samza/system/chooser/MessageChooser.html" target="_top">Frames</a></li>
<li><a href="MessageChooser.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
