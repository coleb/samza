<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_65) on Tue Aug 05 21:46:34 PDT 2014 -->
<title>SystemConsumer (samza-api 0.8.0-SNAPSHOT API)</title>
<meta name="date" content="2014-08-05">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="SystemConsumer (samza-api 0.8.0-SNAPSHOT API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/apache/samza/system/SystemAdmin.html" title="interface in org.apache.samza.system"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/apache/samza/system/SystemFactory.html" title="interface in org.apache.samza.system"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/apache/samza/system/SystemConsumer.html" target="_top">Frames</a></li>
<li><a href="SystemConsumer.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.samza.system</div>
<h2 title="Interface SystemConsumer" class="title">Interface SystemConsumer</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../../org/apache/samza/util/BlockingEnvelopeMap.html" title="class in org.apache.samza.util">BlockingEnvelopeMap</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="strong">SystemConsumer</span></pre>
<div class="block"><p>
 SystemConsumer is the interface that must be implemented by any system that
 wishes to integrate with Samza. Examples of systems that one might want to
 integrate would be systems like Kafka, Hadoop, Kestrel, SQS, etc.
 </p>
 
 <p>
 SamzaContainer uses SystemConsumer to read messages from the underlying
 system, and funnels the messages to the appropriate StreamTask instances. The
 basic flow is for the SamzaContainer to poll for all SystemStreamPartitions,
 feed all IncomingMessageEnvelopes to the appropriate StreamTask, and then
 repeat. If no IncomingMessageEnvelopes are returned, the SamzaContainer polls
 again, but with a timeout of 10ms.
 </p>
 
 <p>
 The SamzaContainer treats SystemConsumer in the following way:
 </p>
 
 <ul>
 <li>Start will be called before stop.</li>
 <li>Register will be called one or more times before start.</li>
 <li>Register won't be called twice for the same SystemStreamPartition.</li>
 <li>If timeout &lt; 0, poll will block unless all SystemStreamPartition are at
 "head" (the underlying system has been checked, and returned an empty set).
 If at head, an empty list is returned.</li>
 <li>If timeout &gt;= 0, poll will return any messages that are currently
 available for any of the SystemStreamPartitions specified. If no new messages
 are available, it will wait up to timeout milliseconds for messages from any
 SystemStreamPartition to become available. It will return an empty list if
 the timeout is hit, and no new messages are available.</li>
 <li>Nothing will be called after stop has been invoked.</li>
 <li>Poll will only be called for registered SystemStreamPartition.</li>
 <li>The SystemConsumer can't assume that a given SystemStreamPartition's
 messages will ever be read. It shouldn't run out of memory or deadlock all
 new message arrivals if one SystemStreamPartition is never read from.</li>
 <li>Any exception thrown by the SystemConsumer means that the SamzaContainer
 should halt.</li>
 </ul>
 
 <p>
 There are generally three implementation styles to this interface:
 </p>
 
 <ol>
 <li>Thread-based</li>
 <li>Selector-based</li>
 <li>Synchronous</li>
 </ol>
 
 <p>
 Thread-based implementations typically use a series of threads to read from
 an underlying system asynchronously, and put the resulting messages into a
 queue, which is then read from whenever the poll method is invoked. The poll
 method's parameters map very closely to Java's BlockingQueue interface.
 BlockingEnvelopeMap is a helper class that makes it easy to implement
 thread-based implementations of SystemConsumer.
 </p>
 
 <p>
 Selector-based implementations typically setup NIO-based non-blocking socket
 that can be selected for new data when poll is called.
 </p>
 
 <p>
 Synchronous implementations simply fetch directly from the underlying system
 whenever poll is invoked. Synchronous implementations must take great care to
 adhere to the timeout rules defined in the poll method.
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/apache/samza/system/SystemConsumer.html#BLOCK_ON_OUTSTANDING_MESSAGES">BLOCK_ON_OUTSTANDING_MESSAGES</a></strong></code>
<div class="block">A constant that can be used in the poll method's timeout parameter to
 denote that the poll invocation should block until at least one message is
 available for one of the SystemStreamPartitions supplied, or until all
 SystemStreamPartitions supplied are at head (have no new messages available
 since the last poll invocation was made for each SystemStreamPartition).</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.util.Map&lt;<a href="../../../../org/apache/samza/system/SystemStreamPartition.html" title="class in org.apache.samza.system">SystemStreamPartition</a>,java.util.List&lt;<a href="../../../../org/apache/samza/system/IncomingMessageEnvelope.html" title="class in org.apache.samza.system">IncomingMessageEnvelope</a>&gt;&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/apache/samza/system/SystemConsumer.html#poll(java.util.Set,%20long)">poll</a></strong>(java.util.Set&lt;<a href="../../../../org/apache/samza/system/SystemStreamPartition.html" title="class in org.apache.samza.system">SystemStreamPartition</a>&gt;&nbsp;systemStreamPartitions,
    long&nbsp;timeout)</code>
<div class="block">Poll the SystemConsumer to get any available messages from the underlying
 system.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/apache/samza/system/SystemConsumer.html#register(org.apache.samza.system.SystemStreamPartition,%20java.lang.String)">register</a></strong>(<a href="../../../../org/apache/samza/system/SystemStreamPartition.html" title="class in org.apache.samza.system">SystemStreamPartition</a>&nbsp;systemStreamPartition,
        java.lang.String&nbsp;offset)</code>
<div class="block">Register a SystemStreamPartition to this SystemConsumer.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/apache/samza/system/SystemConsumer.html#start()">start</a></strong>()</code>
<div class="block">Tells the SystemConsumer to connect to the underlying system, and prepare
 to begin serving messages when poll is invoked.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/apache/samza/system/SystemConsumer.html#stop()">stop</a></strong>()</code>
<div class="block">Tells the SystemConsumer to close all connections, release all resource,
 and shut down everything.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="BLOCK_ON_OUTSTANDING_MESSAGES">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BLOCK_ON_OUTSTANDING_MESSAGES</h4>
<pre>static final&nbsp;int BLOCK_ON_OUTSTANDING_MESSAGES</pre>
<div class="block">A constant that can be used in the poll method's timeout parameter to
 denote that the poll invocation should block until at least one message is
 available for one of the SystemStreamPartitions supplied, or until all
 SystemStreamPartitions supplied are at head (have no new messages available
 since the last poll invocation was made for each SystemStreamPartition).</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../constant-values.html#org.apache.samza.system.SystemConsumer.BLOCK_ON_OUTSTANDING_MESSAGES">Constant Field Values</a></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="start()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>start</h4>
<pre>void&nbsp;start()</pre>
<div class="block">Tells the SystemConsumer to connect to the underlying system, and prepare
 to begin serving messages when poll is invoked.</div>
</li>
</ul>
<a name="stop()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stop</h4>
<pre>void&nbsp;stop()</pre>
<div class="block">Tells the SystemConsumer to close all connections, release all resource,
 and shut down everything. The SystemConsumer will not be used again after
 stop is called.</div>
</li>
</ul>
<a name="register(org.apache.samza.system.SystemStreamPartition, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>register</h4>
<pre>void&nbsp;register(<a href="../../../../org/apache/samza/system/SystemStreamPartition.html" title="class in org.apache.samza.system">SystemStreamPartition</a>&nbsp;systemStreamPartition,
            java.lang.String&nbsp;offset)</pre>
<div class="block">Register a SystemStreamPartition to this SystemConsumer. The SystemConsumer
 should try and read messages from all SystemStreamPartitions that are
 registered to it. SystemStreamPartitions should only be registered before
 start is called.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>systemStreamPartition</code> - The SystemStreamPartition object representing the Samza
          SystemStreamPartition to receive messages from.</dd><dd><code>offset</code> - String representing the offset of the point in the stream to start
          reading messages from. This is an inclusive parameter; if "7" were
          specified, the first message for the system/stream/partition to be
          consumed and returned would be a message whose offset is "7".</dd></dl>
</li>
</ul>
<a name="poll(java.util.Set, long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>poll</h4>
<pre>java.util.Map&lt;<a href="../../../../org/apache/samza/system/SystemStreamPartition.html" title="class in org.apache.samza.system">SystemStreamPartition</a>,java.util.List&lt;<a href="../../../../org/apache/samza/system/IncomingMessageEnvelope.html" title="class in org.apache.samza.system">IncomingMessageEnvelope</a>&gt;&gt;&nbsp;poll(java.util.Set&lt;<a href="../../../../org/apache/samza/system/SystemStreamPartition.html" title="class in org.apache.samza.system">SystemStreamPartition</a>&gt;&nbsp;systemStreamPartitions,
                                                                                long&nbsp;timeout)
                                                                                  throws java.lang.InterruptedException</pre>
<div class="block">Poll the SystemConsumer to get any available messages from the underlying
 system.
 
 <p>
 If the underlying implementation does not take care to adhere to the
 timeout parameter, the SamzaContainer's performance will suffer
 drastically. Specifically, if poll blocks when it's not supposed to, it
 will block the entire main thread in SamzaContainer, and no messages will
 be processed while blocking is occurring.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>systemStreamPartitions</code> - A set of SystemStreamPartition to poll for new messages. If
          SystemConsumer has messages available for other registered
          SystemStreamPartitions, but they are not in the
          systemStreamPartitions set in a given poll invocation, they can't
          be returned. It is illegal to pass in SystemStreamPartitions that
          have not been registered with the SystemConsumer first.</dd><dd><code>timeout</code> - If timeout &lt; 0, poll will block unless all SystemStreamPartition
          are at "head" (the underlying system has been checked, and
          returned an empty set). If at head, an empty map is returned. If
          timeout &gt;= 0, poll will return any messages that are currently
          available for any of the SystemStreamPartitions specified. If no
          new messages are available, it will wait up to timeout
          milliseconds for messages from any SystemStreamPartition to become
          available. It will return an empty map if the timeout is hit, and
          no new messages are available.</dd>
<dt><span class="strong">Returns:</span></dt><dd>A map from SystemStreamPartitions to any available
         IncomingMessageEnvelopes for the SystemStreamPartitions. If no
         messages are available for a SystemStreamPartition that was
         supplied in the polling set, the map will not contain a key for the
         SystemStreamPartition. Will return an empty map, not null, if no
         new messages are available for any SystemStreamPartitions in the
         input set.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code> - Thrown when a blocking poll has been interrupted by another
          thread.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/apache/samza/system/SystemAdmin.html" title="interface in org.apache.samza.system"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/apache/samza/system/SystemFactory.html" title="interface in org.apache.samza.system"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/apache/samza/system/SystemConsumer.html" target="_top">Frames</a></li>
<li><a href="SystemConsumer.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
